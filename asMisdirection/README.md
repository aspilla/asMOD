# asMisdirection

Automatically generates and manages macros for Hunter's Misdirection, Rogue's Tricks of the Trade, Evoker's Cauterizing Flame, Priest's Power Infusion, and a general `/assist` macro to automatically target party members.
![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection_2.JPG?raw=true)
<iframe width="560" height="315" src="https://www.youtube.com/embed/E8RZsSN4Cvw?si=B844A-nqeUjtroNt" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## Main Features

*   **Automatic Macro Creation/Update**:
    *   **Assist Macro**: Creates a macro named `as_Assist Tanker` (or `as_탱커지원` for the Korean client) that assists the tank/target.
    *   **Tank Support Macro**: If you are a Hunter (Misdirection), Rogue (Tricks of the Trade), or Evoker (Cauterizing Flame), it creates a macro named after your ability (e.g., `as_Misdirection`). This macro casts the spell on the tank.
    *   **Dealer Infusion Macro**: If a Priest has Power Infusion, it creates a "Power Infusion" macro that casts on an allied damage dealer (the first one found) or a manually set target.

*   **Targeting Method**:
    *   **Automatic Tank Detection**: When in a party or raid, the addon automatically identifies players with the tank role. If no tank can be found, it defaults to your pet.
    *   **Automatic Dealer Detection (for Power Infusion)**: For Priests, it finds a damage dealer role within the group and sets them as the default target for Power Infusion. If none are found, it defaults to the player.
    *   **Manual Targeting with `/afm`**:
        *   Target a friendly player in your group and type `/afm`.
        *   Using `/afm` again on the currently manually set target will clear the manual override and switch back to automatic detection.
    *   **Priority**: Manually set target > Automatically detected role > Default (pet/player).

*   **No Changes During Combat**: Macro target updates due to group changes are delayed until you are out of combat.

## Supported Abilities

*   **General**: `/assist`
*   **Hunter**: Misdirection
*   **Rogue**: Tricks of the Trade
*   **Evoker**: Cauterizing Flame
*   **Priest**: Power Infusion

## How to Use

1.  **Use Macros**: Use the macros generated by this addon (e.g., `as_Assist Tanker`, `as_Misdirection`, `as_Power Infusion`) from your macro interface (accessible with `/m`).
2.  **Change Target Manually**:
    *   To set a specific player as the target for all macros, target that player and type `/afm`.
    *   To clear the manually set target and return to automatic detection, target the currently set player and type `/afm` again.

## Notes

*   When a macro is updated, it attempts to preserve any custom lines you might have added *after* the default `/cast` line for that spell.
![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection.jpg?raw=true)

# asMisdirection 

사냥꾼의 눈속임, 도적의 속임수 거래, 기원사의 소작의 불길, 사제의 마력 주입, 그리고 일반적인 `/assist` (지원) 매크로를 자동으로 파티원 대상을 지원하도록 자동 생성
![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection_2.JPG?raw=true)
<iframe width="560" height="315" src="https://www.youtube.com/embed/E8RZsSN4Cvw?si=B844A-nqeUjtroNt" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## 주요 기능

*   **자동 매크로 생성/업데이트**:
    *   **지원 매크로**: 탱커/대상을 지원하는 `as_탱커지원` (영문 클라이언트의 경우 `as_Assist Tanker`)이라는 이름의 매크로를 생성
    *   **탱커 지원 매크로**: 사냥꾼(눈속임), 도적(속임수 거래), 또는 기원사(소작의 불길)인 경우, 각자의 능력 이름을 딴 매크로(예: `as_눈속임`)를 생성. 이 매크로는 탱커에게 주문을 시전.
    *   **딜러 주입 매크로**: 사제가 마력 주입을 가지고 있는 경우, 아군 데미지 딜러(첫번째 딜러) 또는 수동으로 설정된 대상에게 시전하는 "마력 주입" 매크로를 생성합니다.

*   **대상 지정 방식**:
    *   **자동 탱커 감지**: 파티 또는 공격대에 있을 때, 애드온은 탱커 역할을 가진 플레이어를 자동으로 식별, 탱커를 찾을 수 없는 경우 소환수를 기본값으로 함.
    *   **자동 딜러 감지 (마력 주입용)**: 사제의 경우, 그룹 내에서 딜러 역할을 찾아 마력 주입의 기본 대상으로 지정. 없는 경우 플레이어를 기본값으로 함.
    *   **`/afm`을 사용한 수동 대상 지정**:
        *   그룹 내의 아군 플레이어를 대상으로 지정하고 `/afm`을 입력. 
        *   현재 수동으로 설정된 대상에게 다시 `/afm`을 사용하면 수동 재정의가 해제되고 자동 지정함.
    *   **우선순위**: 수동 설정 대상 > 자동 감지 역할 > 기본값 (소환수/플레이어).

*   **전투 중 변경불가**: 그룹 변경으로 인한 매크로 대상 업데이트는 전투에서 벗어날 때까지 지연됨

## 지원되는 능력

*   **일반**: `/assist` (지원)
*   **사냥꾼**: 눈속임 (Misdirection)
*   **도적**: 속임수 거래 (Tricks of the Trade) 
*   **기원사**: 소작의 불길 (Cauterizing Flame)
*   **사제**: 마력 주입 (Power Infusion)

## 사용 방법

1.  **매크로 사용**: 이 애드온으로 생성된 매크로(예: `as_탱커지원`, `as_눈속임`, `as_마력 주입`)를 매크로 인터페이스(`/m`으로 접근)에서 사용.
2.  **수동으로 대상 변경**:
    *   특정 플레이어를 모든 매크로의 대상으로 설정하려면, 해당 플레이어를 대상으로 지정하고 `/afm`을 입력.
    *   수동으로 설정된 대상을 해제하고 자동 감지로 돌아가려면, 현재 설정된 플레이어를 대상으로 지정하고 다시 `/afm`을 입력.
    

## 참고 사항

*   매크로가 업데이트될 때, 해당 주문에 대한 기본 `/cast` 줄 *뒤에* 사용자가 추가했을 수 있는 사용자 지정 줄을 유지하려고 시도합니다.
![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection.jpg?raw=true)