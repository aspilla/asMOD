# asMisdirection (Midnight)

Automatic macro for Misdirection and Tricks of the Trade.

![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection_2.JPG?raw=true)

<iframe width="560" height="315" src="https://www.youtube.com/embed/E8RZsSN4Cvw?si=B844A-nqeUjtroNt" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## Key Features

* **Macro Types**:
    * **Tank Assist Macro (`as_AssistTank`)**: Automatically targets your tank's target.
    * **Misdirection Macro (`as_SpellName`)**: Automatically updates macros to cast Hunter's [`Misdirection`], Rogue's [`Tricks of the Trade`], or Evoker's [`Blistering Scales`] on the party's tank.
    * **Power Infusion Macro**: For Priests, creates the `as_Power Infusion` macro to automatically cast [`Power Infusion`] on an allied damage dealer (the first DPS in the group).
    * **Macro Creation Location**: Class-specific skills (like Misdirection) are prioritized in the Character-Specific macro tab, while assist macros are created in the General Macros tab.

* **Targeting Logic**:
    * **Automatic Tank Detection**: Sets the designated tank in a party/raid as the primary target. If no tank is found, your pet becomes the default.
    * **Automatic DPS Detection (for Power Infusion)**: For Priests, it identifies a DPS role within the group as the primary target. If none are found, the player becomes the default.
    * **Manual Targeting via `/afm`**:
        * Target an allied player in your group and type `/afm` to set them as the specific target.
        * Using `/afm` again on a manually set target will clear the override and revert to automatic detection.
    * **Priority**: Manual Override > Automatically Detected Role > Default (Pet/Player).

* **Combat Lock**: Macros cannot be updated while in combat.

## How to Use
Access the macro interface (type `/m`) and use the macros generated by this addon on your action bars.

## Notes
* When a macro is updated, it preserves any custom lines the user may have added *after* the initial `/cast` line. This allows for additional macro functionality, such as using trinkets.
![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection.jpg?raw=true)

---

# asMisdirection (한밤)

눈속임, 속임수 거래 자동 매크로

![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection_2.JPG?raw=true)

<iframe width="560" height="315" src="https://www.youtube.com/embed/E8RZsSN4Cvw?si=B844A-nqeUjtroNt" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## 주요 기능

*   **매크로 종류**:
    *   **탱커 지원 매크로(`as_탱커지원`)**: 탱커의 대상을 타겟 
    *   **눈속임 매크로(`as_스킬명`)**: 사냥꾼[`눈속임`], 도적[`속임수 거래`], 기원사[`끓어오르는 비늘`]를 파티내 탱커에게 자동으로 시전 하도록 매크로 자동 수정.
    *   **마력주입 매크로**: 사제[`마력 주입`], 아군 데미지 딜러(첫번째 딜러)에게 `as_마력 주입` 매크로를 생성.
    *   **매크로 생성 위치**: 직업 스킬(`눈속임`등)은 케릭별 매크로 칸에 우선적으로 생성, 지원 매크로는 공용 매크로칸에 생성

*   **대상 지정 방식**:
    *   **자동 탱커 감지**: 파티/공격대시 탱커를 기본 대상으로, 탱커를 찾을 수 없는 경우 소환수를 기본값으로 함.
    *   **자동 딜러 감지 (마력 주입용)**: 사제의 경우, 그룹 내에서 딜러 역할을 찾아 마력 주입의 기본 대상으로 지정. 없는 경우 플레이어를 기본값으로 함.
    *   **`/afm`을 사용한 수동 대상 지정**:
        *   그룹 내의 아군 플레이어를 대상으로 지정하고 `/afm`을 입력. 
        *   현재 수동으로 설정된 대상에게 다시 `/afm`을 사용하면 수동 재정의가 해제되고 자동 지정함.
    *   **우선순위**: 수동 설정 대상 > 자동 감지 역할 > 기본값 (소환수/플레이어).

*   **전투 중 변경불가**

## 사용 방법
 이 애드온으로 생성된 매크로를 매크로 인터페이스(`/m`으로 접근)에서 사용.

## 참고 사항
*   매크로가 업데이트될 때, 해당 주문에 대한 기본 `/cast` 줄 *뒤에* 사용자가 추가했을 수 있는 사용자 지정 줄을 유지함. 장신구 사용등 추가 매크로 가능
![sample](https://github.com/aspilla/asMOD/blob/main/.Pictures/asMisdirection.jpg?raw=true)